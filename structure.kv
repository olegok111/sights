#:import random random
#:import os os
#:import NoTransition kivy.uix.screenmanager.NoTransition
#:import SlideTransition kivy.uix.screenmanager.SlideTransition
#:import exitus main.exit_action
#:import life_count main.life_count
#:import pwrite dbwrite.pwrite
#:import pget dbwrite.pget
#:set current_player 'nond'
<Button>:
    font_size: 30
    color: 1,1,1,1

<Label>:
    font_size: 26

<ImageButton>:
    padding: 10

<MainScreen>:
    FloatLayout:
        id: main_scr_layout
        size_hint: 1, 0.5
        Button:
            id: main_scr_new_game
            size_hint: 1, 0.5
            pos_hint: {'top':1}
            text: 'Новая игра'
            on_press:
                root.manager.transition = SlideTransition()
                root.manager.transition.direction = 'down'
                root.manager.current = 'quests'
        Button:
            id: main_scr_exit_button
            size_hint: 0.5, 0.5
            pos_hint: {'bottom':1, 'left':1}
            text: "Выход"
            on_press: exitus(self)
        Button:
            id: main_scr_settings_button
            size_hint: 0.5, 0.5
            pos_hint: {'bottom':1, 'right':1}
            text: 'Настройки'
            on_press:
                root.manager.transition = SlideTransition()
                root.manager.transition.direction = 'left'
                root.manager.current = 'settings'
            disabled: True

<SettingsScreen>:
    BoxLayout:
        orientation: 'vertical'
        size_hint: 0.2, 1
        Button:
            text: '...'
        Button:
            text: '...'
        Button:
            text: '...'
        ImageButton:
            source: 'icons/back.png'
            size_hint: 1, .2
            pos_hint: {'left':1, 'bottom':1}
            on_press:
                root.manager.transition = SlideTransition()
                root.manager.transition.direction = 'right'
                root.manager.current = 'main'

    BoxLayout:
        orientation: 'vertical'
        size_hint: 0.8, 0.75
        pos_hint: {'top':1, 'right':1}
        Button:
            id: dropdown_btn
            text: 'Выбрать игрока...'
            background_color: 0,0,0,0
            background_normal: ''
        Label:
            text: os.getcwd()
        Label:
            text: 'Setting 3'

<QuestChooseScreen>:
    GridLayout:
        cols: 2
        padding: 20, 160
        Button:
            text: 'ЗАО\n(Запад Москвы)'
            size_hint: 1, 1
            on_press:
                root.manager.transition = NoTransition()
                root.manager.current = 'qzao1'
    ImageButton:
        source: 'icons/back.png'
        size_hint: .2, .2
        pos_hint: {'left':1, 'bottom':1}
        on_press:
            root.manager.transition = SlideTransition()
            root.manager.transition.direction = 'up'
            root.manager.current = 'main'

<ZAO1>:
    id: qzao1
    background_color: 0,0,0,1
    background_normal: ''
    BoxLayout:
        orientation: 'vertical'
        Label:
            id: zao_question
            size_hint: 1,.15
            text: 'Какой из этих гербов\nпринадлежит ЗАО? #0'
            halign: 'center'
        GridLayout:
            cols: 2
            rows: 2
            ImageButton:
                id: img_btn_0
                source: 'icons/m_uzao.jpg'
                on_press: life_count(self)
            ImageButton:
                id: img_btn_1
                source: 'icons/cao.jpg'
                on_press: life_count(self)
            ImageButton:
                id: img_btn_2
                source: 'icons/zao.jpg'
                on_press:
                    pwrite(current_player, int(pget(current_player)['points'])+5)
                    root.manager.transition = NoTransition()
                    root.manager.current = 'qzao2'
            ImageButton:
                id: img_btn_3
                source: 'icons/vao.jpg'
                on_press: life_count(self)
    ImageButton:
        source: 'icons/back.png'
        size_hint: .15,.15
        pos_hint: {'left':1, 'top':1}
        on_press:
            root.manager.transition = NoTransition()
            root.manager.current = 'quests'
    Label:
        id: zao1_score_label
        size_hint: .1, .1
        pos_hint: {'right':1, 'top':1}
        text: ''

<ZAO2>:
    id: qzao2
    BoxLayout:
        orientation: 'vertical'
        Label:
            id: zao_question
            size_hint: 1,.15
            text: 'Какая из этих арок\nустановлена в ЗАО?'
            halign: 'center'
        GridLayout:
            cols: 2
            rows: 2
            ImageButton:
                id: img_btn_0
                source: 'icons/arka_moskva.jpg'
                on_press:
                    pwrite(current_player, int(pget(current_player)['points'])+5)
                    zao2_score_label.text = str(pget(current_player)['points'])
                    root.manager.current = 'qzao3'
            ImageButton:
                id: img_btn_1
                source: 'icons/arka_irkutsk.jpg'
                on_press: life_count(self)
            ImageButton:
                id: img_btn_2
                source: 'icons/arka_paris.jpg'
                on_press: life_count(self)
            ImageButton:
                id: img_btn_3
                source: 'icons/arka_brussels.jpeg'
                on_press: life_count(self)

    ImageButton:
        source: 'icons/back.png'
        size_hint: .15,.15
        pos_hint: {'left':1, 'top':1}
        on_press:
            root.manager.transition = NoTransition()
            root.manager.current = 'quests'
    Label:
        id: zao2_score_label
        size_hint: .1, .1
        pos_hint: {'right':1, 'top':1}
        text: ''

<ZAO3>:
    id: qzao3
    BoxLayout:
        orientation: 'vertical'
        Label:
            id: zao_question
            size_hint: 1,.15
            text: 'Когда на территорию ЗАО\nвпервые пришли люди?'
        GridLayout:
            cols: 2
            rows: 2
            Button:
                text: '40 тыс. лет назад'
            Button:
                text: '2-1 тысячелетие до н.э.'
                on_press:
                    root.manager.transition = NoTransition()
                    root.manager.current = 'qzao4'
            Button:
                text: 'IX-X век н.э.'
            Button:
                text: '1147 год'
    ImageButton:
        source: 'icons/back.png'
        size_hint: .15,.15
        pos_hint: {'left':1, 'top':1}
        on_press:
            root.manager.transition = NoTransition()
            root.manager.current = 'quests'
    Label:
        id: zao3_score_label
        size_hint: .1, .1
        pos_hint: {'right':1, 'top':1}
        text: ''

<ZAO4>:
    id: qzao4
    BoxLayout:
        orientation: 'vertical'
        Label:
            id: zao_question
            size_hint: 1,.15
            text: 'Где расположен этот фонтан?'
        Image:
            size_hint: 1,.7
            source: 'icons/pokhischenie_evropy.jpg'
        Button:
            size_hint: 1,.15
            text: 'Варианты ответа >>>'
            on_press:
                root.manager.trasition = NoTransition()
                root.manager.current = 'qzao4a'
    ImageButton:
        source: 'icons/back.png'
        size_hint: .15,.15
        pos_hint: {'left':1, 'top':1}
        on_press:
            root.manager.transition = NoTransition()
            root.manager.current = 'quests'
    Label:
        id: zao3_score_label
        size_hint: .1, .1
        pos_hint: {'right':1, 'top':1}
        text: ''

<ZAO4A>:
    id: qzao4a
    BoxLayout:
        orientation: 'vertical'
        Label:
            id: zao_question
            size_hint: 1,.15
            text: 'Где расположен этот фонтан?'
        GridLayout:
            size_hint: 1,.7
            cols: 2
            rows: 2
            Button:
                text: 'Площадь Дорогомиловская\nЗастава'
                halign: 'center'
            Button:
                text: 'Площадь Европы'
                on_press:
                    root.manager.transition = NoTransition()
                    root.manager.current = 'ending_screen'
            Button:
                text: 'Площадь Индиры Ганди'
            Button:
                text: 'Площадь Джавахарлала Неру'
        Button:
            size_hint: 1,.15
            text: '<<< Картинка'
            on_press:
                root.manager.transition = NoTransition()
                root.manager.current = 'qzao4'
    ImageButton:
        source: 'icons/back.png'
        size_hint: .15,.15
        pos_hint: {'left':1, 'top':1}
        on_press:
            root.manager.transition = NoTransition()
            root.manager.current = 'quests'
    Label:
        id: zao3_score_label
        size_hint: .1, .1
        pos_hint: {'right':1, 'top':1}
        text: ''

<EndingScreen>:
    id:ending_screen
    Label:
        text: 'Поздравляю! Вы ответили на все вопросы по ЗАО!\nУ вас осталось ' + str(life_count(self)) + ' жизней(ь/и).'
        halign: 'center'
    ImageButton:
        id: ending_screen_home_button
        source: 'icons/home.png'
        size_hint: .15,.15
        pos_hint: {'top':1, 'left':1}
        on_press:
            root.manager.transition = NoTransition()
            root.manager.current = 'main'